---
name: automate-refactoring-skill
description: 自动化执行重构任务，遵循文档中的重构方案，持续推进直到完成所有任务
---

# Automate Refactoring Skill

当执行重构任务时，遵循此 skill 以确保任务完整、自动化地完成。

## 核心原则

1. **持续推进**: 在重构过程中持续工作，直到review文档描述的所有方案或问题都已实现或修复。
2. **自主执行**: 在重构工作期间**不要**停下来询问用户，除非遇到歧义或需要澄清的关键设计决策。Debug时如果日志尾部看不到错误信息，注意grep ERROR再找找看。
3. **增量提交**: 以合适的步骤增量提交更改，每次提交应包含一个逻辑完整的变更。
4. **更新待办清单**: 每完成一个步骤后，更新  `{step-id}-TODO.md` 文件以反映进度。

## 执行流程

### 1. 理解重构方案
- 阅读refactored-branch-review artifact
- 理解重构的目标、范围和具体步骤
- 识别需要修改的模块和文件

### 2. 制定执行计划
- 基于重构文档，制定详细的多步骤执行计划，记入 `refactor-global-TODO.md`
- 确定每个步骤的验收标准
- 识别步骤之间的依赖关系

### 3. 逐步执行
对于每个步骤：
1. 制定大致的 `{step-id}-TODO.md` 任务清单
2. 执行代码修改
3. 运行相关测试验证修改
4. 确认运行效果符合预期
6. 更新 `{step-id}-TODO.md` 标记已完成的任务
6. 更新 `refactor-global-TODO.md`
5. 提交更改（使用有意义的 commit message）

### 4. 完成验证
- 当认为重构任务已完成时，回顾重构方案文档
- 检查是否有遗漏的要求
- 如果有未实现的要求，重复执行步骤 3

## 死循环检测

如果一个修订任务已经重复了 **3 次**还没有解决，说明可能进入了死循环：
- 停下来分析根本原因
- 设计一种**完全不同**的修订方式
- 考虑是否需要重新理解问题或查看更多上下文

## 提交规范

每次提交应该：
- 包含清晰、描述性的 commit message
- 只包含一个逻辑完整的变更
- 确保提交后项目仍可正常运行

## 输出要求

完成重构后，提供：
- 已完成的任务摘要
- 任何遗留问题或需要后续关注的事项
- 更新后的 `refactor-global-TODO.md`
