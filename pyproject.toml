[tool.uv.workspace]
members = [
    "agent",
    "fusion",
    "benchmark",
    "packages/core",
    "packages/agent-sdk",
    "packages/fusion-sdk",
    "packages/sender-echo",
    "packages/sender-openapi",
    "packages/sender-http",
    "packages/receiver-http",
    "packages/schema-fs",
    "packages/source-elasticsearch",
    "packages/source-fs",
    "packages/source-mysql",
    "packages/source-oss",
    "packages/demo",
    "packages/view-fs"
]

[tool.uv.sources]
fustor-agent = { workspace = true }
fustor-fusion = { workspace = true }
fustor-core = { workspace = true }
fustor-agent-sdk = { workspace = true }
fustor-fusion-sdk = { workspace = true }
fustor-sender-echo = { workspace = true }
fustor-sender-openapi = { workspace = true }
fustor-sender-http = { workspace = true }
fustor-receiver-http = { workspace = true }
fustor-schema-fs = { workspace = true }
fustor-source-elasticsearch = { workspace = true }
fustor-source-fs = { workspace = true }
fustor-source-mysql = { workspace = true }
fustor-source-oss = { workspace = true }
fustor-demo = { workspace = true }
fustor-view-fs = { workspace = true }

[tool.pytest.ini_options]
pythonpath = [
    "agent/src",
    "fusion/src",
    "packages/core/src",
    "packages/sender-echo/src",
    "packages/sender-openapi/src",
    "packages/sender-http/src",
    "packages/receiver-http/src",
    "packages/schema-fs/src",
    "packages/source-elasticsearch/src",
    "packages/source-fs/src",
    "packages/source-mysql/src",
    "packages/source-oss/src",
    "packages/demo/src",
    "packages/view-fs/src"
]
markers = [
    "timeout: mark test to timeout after X seconds",
]
testpaths = [
    "agent/tests",
    "fusion/tests",
    "packages/*/tests",
    "packages/source_oss/tests"
]
addopts = "-v --tb=short"
asyncio_mode = "strict"
norecursedirs = ["it"]
filterwarnings = [
    "ignore:pythonjsonlogger.jsonlogger:DeprecationWarning",
    "ignore:'crypt' is deprecated and slated for removal:DeprecationWarning:passlib.utils",
]

[dependency-groups]
dev = [
    "freezegun>=1.5.5",
    "moto[s3]>=5.1.18",
    "passlib[bcrypt]>=1.7.4",
    "pytest>=8.4.2",
    "pytest-asyncio>=1.2.0",
    "pytest-mock>=3.15.1",
    "python-jose[cryptography]>=3.5.0",
    "ruff>=0.9.0",
    "mypy>=1.14.0",
    "types-pyyaml",
    "types-requests",
]

[tool.ruff]
line-length = 120
target-version = "py311"

[tool.ruff.lint]
select = ["E", "F", "B", "I"]
ignore = ["E501"]

[tool.mypy]
python_version = "3.11"
strict = false
ignore_missing_imports = true
check_untyped_defs = true
