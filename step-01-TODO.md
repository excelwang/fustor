# Step 01: Fix EventMapper Security and Logic

- [x] Create `packages/core/tests/pipeline/test_mapper.py` to reproduce issues and define expected behavior <!-- id: 0 -->
- [x] Refactor `packages/core/src/fustor_core/pipeline/mapper.py` to remove `exec` and add features <!-- id: 1 -->
- [x] Run tests to verify fixes <!-- id: 2 -->
- [x] Update `refactor-global-TODO.md` <!-- id: 3 -->
